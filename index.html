<!doctype html>
<html lang="uk" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ß–∞—Ä—ñ–≤–Ω—ñ –•–º–∞—Ä–∏–Ω–∫–∏</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Nunito', sans-serif; }
    
    .word-card {
      cursor: grab;
      transition: all 0.2s ease;
      user-select: none;
      touch-action: none;
    }
    
    .word-card:active {
      cursor: grabbing;
    }
    
    .word-card.dragging {
      opacity: 0.8;
      transform: scale(1.05) rotate(2deg);
      z-index: 1000;
    }
    
    .category-zone {
      transition: all 0.3s ease;
    }
    
    .category-zone.drag-over {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(255, 183, 150, 0.5);
    }
    
    .star {
      animation: starPop 0.4s ease-out;
    }
    
    @keyframes starPop {
      0% { transform: scale(0) rotate(-180deg); opacity: 0; }
      50% { transform: scale(1.3) rotate(10deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    
    @keyframes gentleBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    
    .bounce-gentle {
      animation: gentleBounce 2s ease-in-out infinite;
    }
    
    @keyframes floatCloud {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(-3px) translateX(2px); }
      75% { transform: translateY(2px) translateX(-2px); }
    }
    
    .float-cloud {
      animation: floatCloud 4s ease-in-out infinite;
    }
    
    @keyframes floatCloudTopLeft {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(-4px) translateX(3px); }
      75% { transform: translateY(3px) translateX(-4px); }
    }
    
    @keyframes floatCloudTopRight {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(-3px) translateX(-3px); }
      75% { transform: translateY(4px) translateX(4px); }
    }
    
    @keyframes floatCloudBottomLeft {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(3px) translateX(4px); }
      75% { transform: translateY(-4px) translateX(-3px); }
    }
    
    @keyframes floatCloudBottomRight {
      0%, 100% { transform: translateY(0) translateX(0); }
      25% { transform: translateY(4px) translateX(-3px); }
      75% { transform: translateY(-3px) translateX(3px); }
    }
    
    .float-cloud-top-left {
      animation: floatCloudTopLeft 5s ease-in-out infinite;
    }
    
    .float-cloud-top-right {
      animation: floatCloudTopRight 5.5s ease-in-out infinite;
    }
    
    .float-cloud-bottom-left {
      animation: floatCloudBottomLeft 6s ease-in-out infinite;
    }
    
    .float-cloud-bottom-right {
      animation: floatCloudBottomRight 5.8s ease-in-out infinite;
    }
    
    .decorative-cloud {
      position: fixed;
      opacity: 0.6;
      pointer-events: none;
      z-index: -1;
    }
    
    .decorative-cloud.top-left {
      top: 10px;
      left: 10px;
    }
    
    .decorative-cloud.top-right {
      top: 10px;
      right: 10px;
    }
    
    .decorative-cloud.bottom-left {
      bottom: 10px;
      left: 10px;
    }
    
    .decorative-cloud.bottom-right {
      bottom: 10px;
      right: 10px;
    }
    
    .feedback-toast {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .completed-card {
      opacity: 0.6;
      pointer-events: none;
    }
    
    .puzzle-piece {
      transition: all 0.4s ease;
    }
    
    .puzzle-piece.revealed {
      opacity: 1;
    }
    
    .puzzle-piece.hidden {
      opacity: 0.15;
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-auto">
  <div id="app" class="min-h-full w-full p-4 md:p-6"><!-- –ü—Ä–∏–∫—Ä–∞—Å–Ω—ñ —Ö–º–∞—Ä–∏–Ω–∫–∏ -->
   <div class="decorative-cloud top-left float-cloud-top-left">
    <svg width="80" height="50" viewbox="0 0 120 80" fill="none"><ellipse cx="60" cy="50" rx="50" ry="25" fill="#E8F4F8" /> <ellipse cx="35" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="85" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="60" cy="35" rx="30" ry="22" fill="#F0F9FC" />
    </svg>
   </div>
   <div class="decorative-cloud top-right float-cloud-top-right">
    <svg width="80" height="50" viewbox="0 0 120 80" fill="none"><ellipse cx="60" cy="50" rx="50" ry="25" fill="#E8F4F8" /> <ellipse cx="35" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="85" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="60" cy="35" rx="30" ry="22" fill="#F0F9FC" />
    </svg>
   </div>
   <div class="decorative-cloud bottom-left float-cloud-bottom-left">
    <svg width="80" height="50" viewbox="0 0 120 80" fill="none"><ellipse cx="60" cy="50" rx="50" ry="25" fill="#E8F4F8" /> <ellipse cx="35" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="85" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="60" cy="35" rx="30" ry="22" fill="#F0F9FC" />
    </svg>
   </div>
   <div class="decorative-cloud bottom-right float-cloud-bottom-right">
    <svg width="80" height="50" viewbox="0 0 120 80" fill="none"><ellipse cx="60" cy="50" rx="50" ry="25" fill="#E8F4F8" /> <ellipse cx="35" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="85" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="60" cy="35" rx="30" ry="22" fill="#F0F9FC" />
    </svg>
   </div><!-- –ì–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω -->
   <div id="start-screen" class="min-h-full flex flex-col items-center justify-center text-center px-4">
    <div class="float-cloud mb-6">
     <svg width="120" height="80" viewbox="0 0 120 80" fill="none"><ellipse cx="60" cy="50" rx="50" ry="25" fill="#E8F4F8" /> <ellipse cx="35" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="85" cy="45" rx="25" ry="20" fill="#E8F4F8" /> <ellipse cx="60" cy="35" rx="30" ry="22" fill="#F0F9FC" /> <circle cx="45" cy="42" r="4" fill="#2D3748" /> <circle cx="75" cy="42" r="4" fill="#2D3748" /> <path d="M55 52 Q60 56 65 52" stroke="#2D3748" stroke-width="2" fill="none" stroke-linecap="round" />
     </svg>
    </div>
    <h1 id="main-title" class="text-3xl md:text-4xl font-extrabold mb-4">–ß–∞—Ä—ñ–≤–Ω—ñ –•–º–∞—Ä–∏–Ω–∫–∏</h1>
    <p class="text-lg mb-8 max-w-md">–î–æ–ø–æ–º–æ–∂–∏ —Å–ª–æ–≤–∞–º –∑–Ω–∞–π—Ç–∏ —Å–≤–æ—ó —Ö–º–∞—Ä–∏–Ω–∫–∏! –ü–µ—Ä–µ—Ç—è–≥–Ω–∏ –∫–æ–∂–Ω–µ —Å–ª–æ–≤–æ –¥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó.</p>
    <div class="mb-8">
     <p class="text-sm font-semibold mb-3">–û–±–µ—Ä–∏ —Ä—ñ–≤–µ–Ω—å:</p>
     <div class="flex flex-wrap justify-center gap-3"><button onclick="startGame('easy')" class="level-btn px-6 py-3 rounded-2xl font-bold transition-all hover:scale-105 active:scale-95"> üå± –õ–µ–≥–∫–∏–π </button> <button onclick="startGame('medium')" class="level-btn px-6 py-3 rounded-2xl font-bold transition-all hover:scale-105 active:scale-95"> üåª –°–µ—Ä–µ–¥–Ω—ñ–π </button> <button onclick="startGame('hard')" class="level-btn px-6 py-3 rounded-2xl font-bold transition-all hover:scale-105 active:scale-95"> üåü –°–∫–ª–∞–¥–Ω–∏–π </button>
     </div>
    </div>
   </div><!-- –Ü–≥—Ä–æ–≤–∏–π –µ–∫—Ä–∞–Ω -->
   <div id="game-screen" class="hidden min-h-full flex flex-col"><!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —ñ –ø—Ä–æ–≥—Ä–µ—Å -->
    <header class="flex flex-wrap items-center justify-between gap-4 mb-4">
     <div class="flex items-center gap-3"><button onclick="showStartScreen()" class="back-btn w-10 h-10 rounded-full flex items-center justify-center transition-all hover:scale-110">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M15 18l-6-6 6-6" />
       </svg></button>
      <h2 id="game-title" class="text-xl md:text-2xl font-bold">–ß–∞—Ä—ñ–≤–Ω—ñ –•–º–∞—Ä–∏–Ω–∫–∏</h2>
     </div>
     <div class="flex items-center gap-4">
      <div id="stars-container" class="flex items-center gap-1"><!-- –ó—ñ—Ä–æ—á–∫–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ -->
      </div>
      <div class="progress-info px-4 py-2 rounded-xl"><span id="progress-text" class="font-semibold">0 / 8</span>
      </div><button id="hint-btn" onclick="useHint()" class="hint-btn px-4 py-2 rounded-xl font-semibold transition-all hover:scale-105 flex items-center gap-2"> ü™Ñ <span id="hint-count">1</span> </button>
     </div>
    </header><!-- –ó–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤'—è–∑–æ–∫ -->
    <div id="feedback-container" class="h-16 flex items-center justify-center mb-4">
     <div id="feedback-toast" class="hidden feedback-toast px-6 py-3 rounded-2xl font-semibold text-center max-w-md"></div>
    </div><!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó -->
    <div id="categories-container" class="grid gap-4 mb-6"><!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –¥–æ–¥–∞—é—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ -->
    </div><!-- –°–ª–æ–≤–∞ –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è -->
    <div class="mt-auto">
     <p class="text-center text-sm font-medium mb-3 opacity-70">–ü–µ—Ä–µ—Ç—è–≥–Ω–∏ —Å–ª–æ–≤–∞ –¥–æ —Ö–º–∞—Ä–∏–Ω–æ–∫:</p>
     <div id="words-container" class="flex flex-wrap justify-center gap-3 p-4 rounded-2xl min-h-24"><!-- –°–ª–æ–≤–∞ –¥–æ–¥–∞—é—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ -->
     </div>
    </div><!-- –ü–∞–∑–ª-–Ω–∞–≥–æ—Ä–æ–¥–∞ -->
    <div id="puzzle-container" class="hidden mt-4">
     <p class="text-center text-sm font-medium mb-2">–¢–≤—ñ–π –ø–∞–∑–ª:</p>
     <div id="puzzle-grid" class="flex justify-center gap-1"><!-- –ß–∞—Å—Ç–∏–Ω–∏ –ø–∞–∑–ª–∞ -->
     </div>
    </div>
   </div><!-- –ï–∫—Ä–∞–Ω –ø–µ—Ä–µ–º–æ–≥–∏ -->
   <div id="win-screen" class="hidden min-h-full flex flex-col items-center justify-center text-center px-4">
    <div class="bounce-gentle mb-6">
     <svg width="100" height="100" viewbox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="45" fill="#FFE4B5" /> <circle cx="50" cy="50" r="38" fill="#FFD700" /> <text x="50" y="58" text-anchor="middle" font-size="40">
       ‚≠ê
      </text>
     </svg>
    </div>
    <h2 class="text-3xl md:text-4xl font-extrabold mb-4">–ß—É–¥–æ–≤–æ!</h2>
    <p id="win-message" class="text-lg mb-2">–¢–∏ —Ä–æ–∑–∫–ª–∞–≤ —É—Å—ñ —Å–ª–æ–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!</p>
    <p id="win-stats" class="text-base mb-8 opacity-80"></p>
    <div class="flex flex-wrap justify-center gap-4"><button onclick="restartGame()" class="play-again-btn px-8 py-3 rounded-2xl font-bold transition-all hover:scale-105 active:scale-95"> üîÑ –ì—Ä–∞—Ç–∏ —â–µ </button> <button onclick="showStartScreen()" class="home-btn px-8 py-3 rounded-2xl font-bold transition-all hover:scale-105 active:scale-95"> üè† –ù–∞ –ø–æ—á–∞—Ç–æ–∫ </button>
    </div>
   </div>
  </div>
  <script>
    // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
    const defaultConfig = {
      game_title: '–ß–∞—Ä—ñ–≤–Ω—ñ –•–º–∞—Ä–∏–Ω–∫–∏',
      category_1_name: '–ó–≤—É–∫ [–†]',
      category_2_name: '–ó–≤—É–∫ [–õ]',
      category_3_name: '–ó–≤—É–∫ [–°]',
      success_message: '–ß—É–¥–æ–≤–æ! –°–ª–æ–≤–æ –∑–Ω–∞–π—à–ª–æ —Å–≤—ñ–π –¥—ñ–º!',
      try_again_message: '–ü–æ–¥—É–º–∞–π —â–µ —Ä–∞–∑. –ü–æ—Å–ª—É—Ö–∞–π –ø–µ—Ä—à–∏–π –∑–≤—É–∫ —É–≤–∞–∂–Ω–æ.',
      background_color: '#FFF5EE',
      surface_color: '#FFFFFF',
      text_color: '#4A5568',
      primary_action_color: '#FFB796',
      secondary_action_color: '#B8E6CF',
      font_family: 'Nunito',
      font_size: 16
    };

    // –î–∞–Ω—ñ –≥—Ä–∏
    const gameData = {
      easy: {
        categories: 2,
        words: [
          { text: 'üöÄ –†–∞–∫–µ—Ç–∞', category: 0, sound: '–†' },
          { text: 'üêü –†–∏–±–∞', category: 0, sound: '–†' },
          { text: 'üåπ –¢—Ä–æ—è–Ω–¥–∞', category: 0, sound: '–†' },
          { text: 'ü¶ä –õ–∏—Å–∏—Ü—è', category: 1, sound: '–õ' },
          { text: 'üçã –õ–∏–º–æ–Ω', category: 1, sound: '–õ' },
          { text: 'üßª –†—É—à–Ω–∏–∫', category: 0, sound: '–†' }
        ]
      },
      medium: {
        categories: 3,
        words: [
          { text: 'üöÄ –†–∞–∫–µ—Ç–∞', category: 0, sound: '–†' },
          { text: 'üêü –†–∏–±–∞', category: 0, sound: '–†' },
          { text: 'üåπ –¢—Ä–æ—è–Ω–¥–∞', category: 0, sound: '–†' },
          { text: 'ü¶ä –õ–∏—Å–∏—Ü—è', category: 1, sound: '–õ' },
          { text: 'üçã –õ–∏–º–æ–Ω', category: 1, sound: '–õ' },
          { text: 'üßª –†—É—à–Ω–∏–∫', category: 0, sound: '–†' },
          { text: '‚òÄÔ∏è –°–æ–Ω—Ü–µ', category: 2, sound: '–°' },
          { text: 'üêò –°–ª–æ–Ω', category: 2, sound: '–°' },
          { text: 'üßÄ –°–∏—Ä', category: 2, sound: '–°' }
        ]
      },
      hard: {
        categories: 3,
        words: [
          { text: 'üöÄ –†–∞–∫–µ—Ç–∞', category: 0, sound: '–†' },
          { text: 'üêü –†–∏–±–∞', category: 0, sound: '–†' },
          { text: 'üåπ –¢—Ä–æ—è–Ω–¥–∞', category: 0, sound: '–†' },
          { text: 'üñºÔ∏è –ö–∞—Ä—Ç–∏–Ω–∞', category: 0, sound: '–†' },
          { text: 'ü¶ä –õ–∏—Å–∏—Ü—è', category: 1, sound: '–õ' },
          { text: 'üçã –õ–∏–º–æ–Ω', category: 1, sound: '–õ' },
          { text: 'üßª –†—É—à–Ω–∏–∫', category: 0, sound: '–†' },
          { text: 'ü™Å –õ—ñ—Ç–∞–∫', category: 1, sound: '–õ' },
          { text: '‚òÄÔ∏è –°–æ–Ω—Ü–µ', category: 2, sound: '–°' },
          { text: 'üêò –°–ª–æ–Ω', category: 2, sound: '–°' },
          { text: 'üßÄ –°–∏—Ä', category: 2, sound: '–°' },
          { text: 'üéí –°—É–º–∫–∞', category: 2, sound: '–°' }
        ]
      }
    };

    const successMessages = [
      '–ß—É–¥–æ–≤–æ! –°–ª–æ–≤–æ –∑–Ω–∞–π—à–ª–æ —Å–≤—ñ–π –¥—ñ–º!',
      '–ú–æ–ª–æ–¥–µ—Ü—å! –¢–∏ —É–≤–∞–∂–Ω–æ —Å–ª—É—Ö–∞–≤!',
      '–°—É–ø–µ—Ä! –¢–∏ –¥–æ–±—Ä–µ –ø–æ—á—É–≤ –∑–≤—É–∫!',
      '–¢–æ—á–Ω–æ! –î–∞–≤–∞–π —â–µ –æ–¥–Ω–µ!',
      '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –¢–∏ –º–æ–ª–æ–¥–µ—Ü—å!'
    ];

    const tryAgainMessages = [
      '–ü–æ–¥—É–º–∞–π —â–µ —Ä–∞–∑. –ü–æ—Å–ª—É—Ö–∞–π –ø–µ—Ä—à–∏–π –∑–≤—É–∫ —É–≤–∞–∂–Ω–æ.',
      '–°–ø—Ä–æ–±—É–π –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ —Å–∫–∞–∑–∞—Ç–∏ —Å–ª–æ–≤–æ.',
      '–ú–æ–∂–ª–∏–≤–æ, —Ü–µ —Å–ª–æ–≤–æ —Ö–æ—á–µ –≤ —ñ–Ω—à—É —Ö–º–∞—Ä–∏–Ω–∫—É?',
      '–î–∞–≤–∞–π —Ä–∞–∑–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ. –Ø–∫–∏–π –ø–µ—Ä—à–∏–π –∑–≤—É–∫?'
    ];

    // –°—Ç–∞–Ω –≥—Ä–∏
    let currentLevel = 'easy';
    let words = [];
    let completedWords = 0;
    let stars = 0;
    let hintsRemaining = 1;
    let draggedElement = null;
    let touchStartX = 0;
    let touchStartY = 0;

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          applyConfig(config);
        },
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => { config.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => { config.surface_color = value; window.elementSdk.setConfig({ surface_color: value }); }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => { config.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => { config.primary_action_color = value; window.elementSdk.setConfig({ primary_action_color: value }); }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => { config.secondary_action_color = value; window.elementSdk.setConfig({ secondary_action_color: value }); }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => { config.font_family = value; window.elementSdk.setConfig({ font_family: value }); }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => { config.font_size = value; window.elementSdk.setConfig({ font_size: value }); }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ['game_title', config.game_title || defaultConfig.game_title],
          ['category_1_name', config.category_1_name || defaultConfig.category_1_name],
          ['category_2_name', config.category_2_name || defaultConfig.category_2_name],
          ['category_3_name', config.category_3_name || defaultConfig.category_3_name],
          ['success_message', config.success_message || defaultConfig.success_message],
          ['try_again_message', config.try_again_message || defaultConfig.try_again_message]
        ])
      });
    }

    function applyConfig(config) {
      const cfg = { ...defaultConfig, ...config };
      const fontFamily = cfg.font_family + ', Nunito, sans-serif';
      const baseSize = cfg.font_size;

      // –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤
      document.getElementById('app').style.background = cfg.background_color;
      document.body.style.background = cfg.background_color;
      
      // –¢–µ–∫—Å—Ç–æ–≤—ñ –∫–æ–ª—å–æ—Ä–∏
      document.querySelectorAll('#main-title, #game-title, h1, h2, p, span').forEach(el => {
        el.style.color = cfg.text_color;
      });

      // –ö–Ω–æ–ø–∫–∏ —Ä—ñ–≤–Ω—ñ–≤
      document.querySelectorAll('.level-btn').forEach(btn => {
        btn.style.background = cfg.surface_color;
        btn.style.color = cfg.text_color;
        btn.style.boxShadow = `0 4px 15px ${cfg.primary_action_color}40`;
      });

      // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
      document.querySelectorAll('.back-btn').forEach(btn => {
        btn.style.background = cfg.surface_color;
        btn.style.color = cfg.text_color;
      });

      // –ü—Ä–æ–≥—Ä–µ—Å
      document.querySelectorAll('.progress-info').forEach(el => {
        el.style.background = cfg.surface_color;
        el.style.color = cfg.text_color;
      });

      // –ö–Ω–æ–ø–∫–∞ –ø—ñ–¥–∫–∞–∑–∫–∏
      document.querySelectorAll('.hint-btn').forEach(btn => {
        btn.style.background = cfg.secondary_action_color;
        btn.style.color = cfg.text_color;
      });

      // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ª—ñ–≤
      const wordsContainer = document.getElementById('words-container');
      if (wordsContainer) {
        wordsContainer.style.background = cfg.surface_color;
      }

      // –ö–∞—Ä—Ç–∫–∏ —Å–ª—ñ–≤
      document.querySelectorAll('.word-card').forEach(card => {
        card.style.background = cfg.surface_color;
        card.style.color = cfg.text_color;
        card.style.boxShadow = `0 3px 10px ${cfg.primary_action_color}30`;
      });

      // –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó
      document.querySelectorAll('.category-zone').forEach(zone => {
        zone.style.background = `${cfg.surface_color}CC`;
        zone.style.borderColor = cfg.primary_action_color;
      });

      // –ö–Ω–æ–ø–∫–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ –ø–µ—Ä–µ–º–æ–≥–∏
      document.querySelectorAll('.play-again-btn').forEach(btn => {
        btn.style.background = cfg.primary_action_color;
        btn.style.color = cfg.text_color;
      });

      document.querySelectorAll('.home-btn').forEach(btn => {
        btn.style.background = cfg.secondary_action_color;
        btn.style.color = cfg.text_color;
      });

      // –®—Ä–∏—Ñ—Ç–∏
      document.body.style.fontFamily = fontFamily;
      
      document.querySelectorAll('h1, #main-title').forEach(el => {
        el.style.fontFamily = fontFamily;
        el.style.fontSize = `${baseSize * 2}px`;
      });

      document.querySelectorAll('h2, #game-title').forEach(el => {
        el.style.fontFamily = fontFamily;
        el.style.fontSize = `${baseSize * 1.5}px`;
      });

      document.querySelectorAll('p, span, button').forEach(el => {
        el.style.fontFamily = fontFamily;
      });

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞–∑–≤
      document.getElementById('main-title').textContent = cfg.game_title;
      document.getElementById('game-title').textContent = cfg.game_title;

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —è–∫—â–æ –≥—Ä–∞ –∞–∫—Ç–∏–≤–Ω–∞
      updateCategoryNames(cfg);
    }

    function updateCategoryNames(cfg) {
      const categories = document.querySelectorAll('.category-title');
      const names = [cfg.category_1_name, cfg.category_2_name, cfg.category_3_name];
      categories.forEach((cat, i) => {
        if (names[i]) cat.textContent = names[i];
      });
    }

    function getConfig() {
      if (window.elementSdk && window.elementSdk.config) {
        return { ...defaultConfig, ...window.elementSdk.config };
      }
      return defaultConfig;
    }

    function startGame(level) {
      currentLevel = level;
      completedWords = 0;
      stars = 0;
      hintsRemaining = 1;
      
      const data = gameData[level];
      words = [...data.words].sort(() => Math.random() - 0.5);
      
      renderGame(data.categories);
      
      document.getElementById('start-screen').classList.add('hidden');
      document.getElementById('game-screen').classList.remove('hidden');
      document.getElementById('win-screen').classList.add('hidden');
      
      applyConfig(getConfig());
    }

    function renderGame(numCategories) {
      const cfg = getConfig();
      const categoryNames = [cfg.category_1_name, cfg.category_2_name, cfg.category_3_name];
      const categoryEmojis = ['‚òÅÔ∏è', 'üå§Ô∏è', '‚õÖ'];
      
      // –†–µ–Ω–¥–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
      const categoriesContainer = document.getElementById('categories-container');
      categoriesContainer.className = `grid gap-4 mb-6 ${numCategories === 2 ? 'md:grid-cols-2' : 'md:grid-cols-3'}`;
      categoriesContainer.innerHTML = '';
      
      for (let i = 0; i < numCategories; i++) {
        const zone = document.createElement('div');
        zone.className = 'category-zone rounded-3xl p-4 min-h-32 border-3 border-dashed flex flex-col';
        zone.style.borderWidth = '3px';
        zone.dataset.category = i;
        
        zone.innerHTML = `
          <div class="flex items-center gap-2 mb-3">
            <span class="text-2xl">${categoryEmojis[i]}</span>
            <span class="category-title font-bold text-lg">${categoryNames[i]}</span>
          </div>
          <div class="sorted-words flex flex-wrap gap-2 flex-1"></div>
        `;
        
        // –ü–æ–¥—ñ—ó drag and drop
        zone.addEventListener('dragover', handleDragOver);
        zone.addEventListener('dragleave', handleDragLeave);
        zone.addEventListener('drop', handleDrop);
        
        categoriesContainer.appendChild(zone);
      }
      
      // –†–µ–Ω–¥–µ—Ä —Å–ª—ñ–≤
      const wordsContainer = document.getElementById('words-container');
      wordsContainer.innerHTML = '';
      
      words.forEach((word, index) => {
        const card = createWordCard(word, index);
        wordsContainer.appendChild(card);
      });
      
      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è UI
      updateProgress();
      updateStars();
      document.getElementById('hint-count').textContent = hintsRemaining;
      
      // –†–µ–Ω–¥–µ—Ä –ø–∞–∑–ª–∞
      renderPuzzle();
    }

    function createWordCard(word, index) {
      const cfg = getConfig();
      const card = document.createElement('div');
      card.className = 'word-card px-5 py-3 rounded-2xl font-semibold text-lg';
      card.style.boxShadow = `0 3px 10px ${cfg.primary_action_color}30`;
      card.textContent = word.text;
      card.draggable = true;
      card.dataset.index = index;
      card.dataset.category = word.category;
      
      // Mouse events
      card.addEventListener('dragstart', handleDragStart);
      card.addEventListener('dragend', handleDragEnd);
      
      // Touch events
      card.addEventListener('touchstart', handleTouchStart, { passive: false });
      card.addEventListener('touchmove', handleTouchMove, { passive: false });
      card.addEventListener('touchend', handleTouchEnd);
      
      return card;
    }

    function handleDragStart(e) {
      draggedElement = e.target;
      e.target.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragEnd(e) {
      e.target.classList.remove('dragging');
      document.querySelectorAll('.category-zone').forEach(zone => {
        zone.classList.remove('drag-over');
      });
    }

    function handleDragOver(e) {
      e.preventDefault();
      e.currentTarget.classList.add('drag-over');
    }

    function handleDragLeave(e) {
      e.currentTarget.classList.remove('drag-over');
    }

    function handleDrop(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('drag-over');
      
      if (draggedElement) {
        const targetCategory = parseInt(e.currentTarget.dataset.category);
        const wordCategory = parseInt(draggedElement.dataset.category);
        
        checkAnswer(draggedElement, targetCategory, wordCategory, e.currentTarget);
      }
    }

    // Touch handling
    function handleTouchStart(e) {
      e.preventDefault();
      const touch = e.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;
      
      draggedElement = e.target;
      draggedElement.classList.add('dragging');
      
      const rect = draggedElement.getBoundingClientRect();
      draggedElement.style.position = 'fixed';
      draggedElement.style.left = rect.left + 'px';
      draggedElement.style.top = rect.top + 'px';
      draggedElement.style.width = rect.width + 'px';
      draggedElement.style.zIndex = '1000';
    }

    function handleTouchMove(e) {
      e.preventDefault();
      if (!draggedElement) return;
      
      const touch = e.touches[0];
      const deltaX = touch.clientX - touchStartX;
      const deltaY = touch.clientY - touchStartY;
      
      const rect = draggedElement.getBoundingClientRect();
      draggedElement.style.left = (parseFloat(draggedElement.style.left) + (touch.clientX - (rect.left + rect.width/2))) + 'px';
      draggedElement.style.top = (parseFloat(draggedElement.style.top) + (touch.clientY - (rect.top + rect.height/2))) + 'px';
      
      // Highlight category under touch
      document.querySelectorAll('.category-zone').forEach(zone => {
        const zoneRect = zone.getBoundingClientRect();
        if (touch.clientX >= zoneRect.left && touch.clientX <= zoneRect.right &&
            touch.clientY >= zoneRect.top && touch.clientY <= zoneRect.bottom) {
          zone.classList.add('drag-over');
        } else {
          zone.classList.remove('drag-over');
        }
      });
    }

    function handleTouchEnd(e) {
      if (!draggedElement) return;
      
      const touch = e.changedTouches[0];
      let dropTarget = null;
      
      document.querySelectorAll('.category-zone').forEach(zone => {
        const rect = zone.getBoundingClientRect();
        if (touch.clientX >= rect.left && touch.clientX <= rect.right &&
            touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
          dropTarget = zone;
        }
        zone.classList.remove('drag-over');
      });
      
      draggedElement.style.position = '';
      draggedElement.style.left = '';
      draggedElement.style.top = '';
      draggedElement.style.width = '';
      draggedElement.style.zIndex = '';
      draggedElement.classList.remove('dragging');
      
      if (dropTarget) {
        const targetCategory = parseInt(dropTarget.dataset.category);
        const wordCategory = parseInt(draggedElement.dataset.category);
        checkAnswer(draggedElement, targetCategory, wordCategory, dropTarget);
      }
      
      draggedElement = null;
    }

    function checkAnswer(card, targetCategory, correctCategory, dropZone) {
      const cfg = getConfig();
      
      if (targetCategory === correctCategory) {
        // –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
        const sortedContainer = dropZone.querySelector('.sorted-words');
        card.classList.add('completed-card');
        card.draggable = false;
        sortedContainer.appendChild(card);
        
        completedWords++;
        stars++;
        
        updateProgress();
        updateStars();
        revealPuzzlePiece();
        showFeedback(true);
        
        if (completedWords === words.length) {
          setTimeout(showWinScreen, 1500);
        }
      } else {
        // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
        showFeedback(false);
        card.classList.add('shake');
        setTimeout(() => card.classList.remove('shake'), 500);
      }
    }

    function showFeedback(isCorrect) {
      const cfg = getConfig();
      const toast = document.getElementById('feedback-toast');
      
      if (isCorrect) {
        const messages = [cfg.success_message, ...successMessages];
        toast.textContent = messages[Math.floor(Math.random() * messages.length)];
        toast.style.background = cfg.secondary_action_color;
      } else {
        const messages = [cfg.try_again_message, ...tryAgainMessages];
        toast.textContent = messages[Math.floor(Math.random() * messages.length)];
        toast.style.background = cfg.primary_action_color;
      }
      
      toast.style.color = cfg.text_color;
      toast.classList.remove('hidden');
      
      setTimeout(() => {
        toast.classList.add('hidden');
      }, 2500);
    }

    function updateProgress() {
      document.getElementById('progress-text').textContent = `${completedWords} / ${words.length}`;
    }

    function updateStars() {
      const cfg = getConfig();
      const container = document.getElementById('stars-container');
      container.innerHTML = '';
      
      for (let i = 0; i < stars; i++) {
        const star = document.createElement('span');
        star.className = 'star text-2xl';
        star.textContent = '‚≠ê';
        star.style.animationDelay = `${i * 0.1}s`;
        container.appendChild(star);
      }
    }

    function renderPuzzle() {
      const container = document.getElementById('puzzle-container');
      const grid = document.getElementById('puzzle-grid');
      
      if (currentLevel === 'easy') {
        container.classList.add('hidden');
        return;
      }
      
      container.classList.remove('hidden');
      grid.innerHTML = '';
      
      const pieces = currentLevel === 'hard' ? 12 : 9;
      
      for (let i = 0; i < pieces; i++) {
        const piece = document.createElement('div');
        piece.className = 'puzzle-piece hidden w-6 h-6 rounded bg-gradient-to-br from-yellow-300 to-orange-400';
        piece.dataset.index = i;
        grid.appendChild(piece);
      }
    }

    function revealPuzzlePiece() {
      const pieces = document.querySelectorAll('.puzzle-piece.hidden');
      if (pieces.length > 0) {
        pieces[0].classList.remove('hidden');
        pieces[0].classList.add('revealed');
      }
    }

    function useHint() {
      if (hintsRemaining <= 0) return;
      
      const remainingCards = document.querySelectorAll('#words-container .word-card:not(.completed-card)');
      if (remainingCards.length === 0) return;
      
      hintsRemaining--;
      document.getElementById('hint-count').textContent = hintsRemaining;
      
      const card = remainingCards[0];
      const category = card.dataset.category;
      const zone = document.querySelector(`.category-zone[data-category="${category}"]`);
      
      // –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
      zone.style.animation = 'pulse 0.5s ease-in-out 3';
      card.style.animation = 'pulse 0.5s ease-in-out 3';
      
      setTimeout(() => {
        zone.style.animation = '';
        card.style.animation = '';
      }, 1500);
    }

    function showWinScreen() {
      document.getElementById('game-screen').classList.add('hidden');
      document.getElementById('win-screen').classList.remove('hidden');
      
      document.getElementById('win-stats').textContent = `–¢–∏ –∑—ñ–±—Ä–∞–≤ ${stars} ‚≠ê –∑—ñ—Ä–æ—á–æ–∫!`;
      
      applyConfig(getConfig());
    }

    function restartGame() {
      startGame(currentLevel);
    }

    function showStartScreen() {
      document.getElementById('start-screen').classList.remove('hidden');
      document.getElementById('game-screen').classList.add('hidden');
      document.getElementById('win-screen').classList.add('hidden');
      
      applyConfig(getConfig());
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    applyConfig(defaultConfig);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d262ddca70e2de8',t:'MTc3MTg0NDAwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
